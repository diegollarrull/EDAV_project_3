---
title: "Police Districts"
output: pdf_document
---


```{r,echo=FALSE,warning=FALSE,message=FALSE}
library(ggplot2)
library(ggmap)

data <- read.csv('Traffic_Violations.csv')

data <- data[!is.na(data$Geolocation) & data$Geolocation!='',]
data$New.Lat <- pmax(data$Latitude, data$Longitude)
data$New.Lon <- pmin(data$Latitude, data$Longitude)
data$Districts = data$SubAgency
levels(data$Districts) = c('Rockville','Bethesda','Silver Spring','Wheaton','Germantown','Gaithersburg','HQ')

alcohol <- data[grepl('ALCOHOL',data$Description),]
```



```{r,echo=FALSE,warning=FALSE,message=FALSE}
map <- get_map(location = c(lon = -77.129074, lat = 39.10359), zoom = 11,maptype='roadmap')

sample <-data[sample(dim(data)[1],dim(alcohol)[1]),]
ggmap(map,extent = 'device') + 
  geom_point(aes(x=New.Lon, y = New.Lat, color = Districts), alpha = .1, size = 2,data = sample) + 
  guides(colour = guide_legend(override.aes = list(alpha = 1))) + 
  ggtitle('Violations by District')

```


```{r,echo=FALSE,warning=FALSE,message=FALSE}
ggmap(map,extent = 'device') + 
  geom_point(aes(x=New.Lon, y = New.Lat, color = Districts), alpha = .1, size = 2,data = alcohol) + 
  guides(colour = guide_legend(override.aes = list(alpha = 1))) + 
  ggtitle('Alcohol Violations by District')
```

